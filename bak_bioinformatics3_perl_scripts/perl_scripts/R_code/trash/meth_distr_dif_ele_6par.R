meth_dis_dif_ele<-function(cpg,CG,chg,CHG,chh,CHH,OUT){
    pdf(OUT)
    #exp 
    cpg<-read.table(cpg)
    cpg<-cpg[order(cpg[,2]),]
    chg<-read.table(chg)
    chg<-chg[order(chg[,2]),]
    chh<-read.table(chh)
    chh<-chh[order(chh[,2]),]
    #no exp
    CG<-read.table(CG)
    CG<-CG[order(CG[,2]),]
    CHG<-read.table(CHG)
    CHG<-CHG[order(CHG[,2]),]
    CHH<-read.table(CHH)
    CHH<-CHH[order(CHH[,2]),]
    par(mfrow=c(3,2))
    #exp CpG
    cat("log\n") 
    plot(1:101,cpg[cpg[,1]=="upstream",][,3],type="l",ylim=c(min(cpg[,3],CG[,3]),max(cpg[,3],CG[,3])),xlim=c(0,710),col="red",xlab="CpG",ylab="Methylation Level")
    lines(102:202,cpg[cpg[,1]=="first_exon",][,3],col="red")
    lines(203:303,cpg[cpg[,1]=="first_intron",][,3],col="red")
    lines(304:404,cpg[cpg[,1]=="internal_exon",][,3],col="red")
    lines(405:505,cpg[cpg[,1]=="internal_intron",][,3],col="red")
    lines(506:606,cpg[cpg[,1]=="last_exon",][,3],col="red")
    lines(607:707,cpg[cpg[,1]=="downstream",][,3],col="red")
    abline(v=101.5,lty="dashed")
    abline(v=202.5,lty="dashed")
    abline(v=303.5,lty="dashed")
    abline(v=404.5,lty="dashed")
    abline(v=505.5,lty="dashed")
    abline(v=606.5,lty="dashed")
     
    plot(1:101,CG[CG[,1]=="upstream",][,3],type="l",ylim=c(min(cpg[,3],CG[,3]),max(cpg[,3],CG[,3])),xlim=c(0,710),col="red",xlab="CpG",ylab="Methylation Level")
    lines(102:202,CG[CG[,1]=="first_exon",][,3],col="red")
    lines(203:303,CG[CG[,1]=="first_intron",][,3],col="red")
    lines(304:404,CG[CG[,1]=="internal_exon",][,3],col="red")
    lines(405:505,CG[CG[,1]=="internal_intron",][,3],col="red")
    lines(506:606,CG[CG[,1]=="last_exon",][,3],col="red")
    lines(607:707,CG[CG[,1]=="downstream",][,3],col="red")
    abline(v=101.5,lty="dashed")
    abline(v=202.5,lty="dashed")
    abline(v=303.5,lty="dashed")
    abline(v=404.5,lty="dashed") 
    abline(v=505.5,lty="dashed")
    abline(v=606.5,lty="dashed")

    plot(1:101,chg[chg[,1]=="upstream",][,3],type="l",ylim=c(min(chg[,3],CHG[,3]),max(chg[,3],CHG[,3])),xlim=c(0,710),col="RoyalBlue",xlab="CHG",ylab="Methylation Level")
    lines(102:202,chg[chg[,1]=="first_exon",][,3],col="RoyalBlue")
    lines(203:303,chg[chg[,1]=="first_intron",][,3],col="RoyalBlue")
    lines(304:404,chg[chg[,1]=="internal_exon",][,3],col="RoyalBlue")
    lines(405:505,chg[chg[,1]=="internal_intron",][,3],col="RoyalBlue")
    lines(506:606,chg[chg[,1]=="last_exon",][,3],col="RoyalBlue")
    lines(607:707,chg[chg[,1]=="downstream",][,3],col="RoyalBlue")
    abline(v=101.5,lty="dashed")
    abline(v=202.5,lty="dashed")
    abline(v=303.5,lty="dashed")
    abline(v=404.5,lty="dashed")
    abline(v=505.5,lty="dashed")
    abline(v=606.5,lty="dashed")

    plot(1:101,CHG[CHG[,1]=="upstream",][,3],type="l",ylim=c(min(chg[,3],CHG[,3]),max(chg[,3],CHG[,3])),xlim=c(0,710),col="RoyalBlue",xlab="CHG",ylab="Methylation Level")
    lines(102:202,CHG[CHG[,1]=="first_exon",][,3],col="RoyalBlue")
    lines(203:303,CHG[CHG[,1]=="first_intron",][,3],col="RoyalBlue")
    lines(304:404,CHG[CHG[,1]=="internal_exon",][,3],col="RoyalBlue")
    lines(405:505,CHG[CHG[,1]=="internal_intron",][,3],col="RoyalBlue")
    lines(506:606,CHG[CHG[,1]=="last_exon",][,3],col="RoyalBlue")
    lines(607:707,CHG[CHG[,1]=="downstream",][,3],col="RoyalBlue")
    abline(v=101.5,lty="dashed")
    abline(v=202.5,lty="dashed")
    abline(v=303.5,lty="dashed")
    abline(v=404.5,lty="dashed")
    abline(v=505.5,lty="dashed")
    abline(v=606.5,lty="dashed")   
    
    plot(1:101,chh[chh[,1]=="upstream",][,3],type="l",ylim=c(min(chh[,3],CHH[,3]),max(chh[,3],CHH[,3])),xlim=c(0,710),col="PaleGreen4",xlab="CHH",ylab="Methylation Level")
    lines(102:202,chh[chh[,1]=="first_exon",][,3],col="PaleGreen4")
    lines(203:303,chh[chh[,1]=="first_intron",][,3],col="PaleGreen4")
    lines(304:404,chh[chh[,1]=="internal_exon",][,3],col="PaleGreen4")
    lines(405:505,chh[chh[,1]=="internal_intron",][,3],col="PaleGreen4")
    lines(506:606,chh[chh[,1]=="last_exon",][,3],col="PaleGreen4")
    lines(607:707,chh[chh[,1]=="downstream",][,3],col="PaleGreen4")
    abline(v=101.5,lty="dashed")
    abline(v=202.5,lty="dashed")
    abline(v=303.5,lty="dashed")
    abline(v=404.5,lty="dashed")
    abline(v=505.5,lty="dashed")
    abline(v=606.5,lty="dashed")

    plot(1:101,CHH[CHH[,1]=="upstream",][,3],type="l",ylim=c(min(chh[,3],CHH[,3]),max(chh[,3],CHH[,3])),xlim=c(0,710),col="PaleGreen4",xlab="CHH",ylab="Methylation Level")
    lines(102:202,CHH[CHH[,1]=="first_exon",][,3],col="PaleGreen4")
    lines(203:303,CHH[CHH[,1]=="first_intron",][,3],col="PaleGreen4")
    lines(304:404,CHH[CHH[,1]=="internal_exon",][,3],col="PaleGreen4")
    lines(405:505,CHH[CHH[,1]=="internal_intron",][,3],col="PaleGreen4")
    lines(506:606,CHH[CHH[,1]=="last_exon",][,3],col="PaleGreen4")
    lines(607:707,CHH[CHH[,1]=="downstream",][,3],col="PaleGreen4")
    abline(v=101.5,lty="dashed")
    abline(v=202.5,lty="dashed")
    abline(v=303.5,lty="dashed")
    abline(v=404.5,lty="dashed")
    abline(v=505.5,lty="dashed")
    abline(v=606.5,lty="dashed")
 
    dev.off()
}
